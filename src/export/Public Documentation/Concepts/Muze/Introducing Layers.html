<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Introducing Layers</title><style>
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark-href {
	font-size: 0.75em;
	opacity: 0.5;
}

.sans { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, KaiTi, STKaiTi, '华文楷体', KaiTi_GB2312, '楷体_GB2312', serif; }
.mono { font-family: Nitti, 'Microsoft YaHei', '微软雅黑', monospace; }
.pdf .sans { font-family: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC', 'Noto Sans CJK KR'; }

.pdf .code { font-family: Source Code Pro, 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC', 'Noto Sans Mono CJK KR'; }

.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, KaiTi, STKaiTi, '华文楷体', KaiTi_GB2312, '楷体_GB2312', serif, 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC', 'Noto Sans CJK KR'; }

.pdf .mono { font-family: PT Mono, Nitti, 'Microsoft YaHei', '微软雅黑', monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC', 'Noto Sans Mono CJK KR'; }

.highlight-default {
}
.highlight-gray {
	color: rgb(155,154,151);
}
.highlight-brown {
	color: rgb(100,71,58);
}
.highlight-orange {
	color: rgb(217,115,13);
}
.highlight-yellow {
	color: rgb(223,171,1);
}
.highlight-teal {
	color: rgb(15,123,108);
}
.highlight-blue {
	color: rgb(11,110,153);
}
.highlight-purple {
	color: rgb(105,64,165);
}
.highlight-pink {
	color: rgb(173,26,114);
}
.highlight-red {
	color: rgb(224,62,62);
}
.highlight-gray_background {
	background: rgb(235,236,237);
}
.highlight-brown_background {
	background: rgb(233,229,227);
}
.highlight-orange_background {
	background: rgb(250,235,221);
}
.highlight-yellow_background {
	background: rgb(251,243,219);
}
.highlight-teal_background {
	background: rgb(221,237,234);
}
.highlight-blue_background {
	background: rgb(221,235,241);
}
.highlight-purple_background {
	background: rgb(234,228,242);
}
.highlight-pink_background {
	background: rgb(244,223,235);
}
.highlight-red_background {
	background: rgb(251,228,228);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(55, 53, 47, 0.6);
	fill: rgba(55, 53, 47, 0.6);
}
.block-color-brown {
	color: rgb(100,71,58);
	fill: rgb(100,71,58);
}
.block-color-orange {
	color: rgb(217,115,13);
	fill: rgb(217,115,13);
}
.block-color-yellow {
	color: rgb(223,171,1);
	fill: rgb(223,171,1);
}
.block-color-teal {
	color: rgb(15,123,108);
	fill: rgb(15,123,108);
}
.block-color-blue {
	color: rgb(11,110,153);
	fill: rgb(11,110,153);
}
.block-color-purple {
	color: rgb(105,64,165);
	fill: rgb(105,64,165);
}
.block-color-pink {
	color: rgb(173,26,114);
	fill: rgb(173,26,114);
}
.block-color-red {
	color: rgb(224,62,62);
	fill: rgb(224,62,62);
}
.block-color-gray_background {
	background: rgb(235,236,237);
}
.block-color-brown_background {
	background: rgb(233,229,227);
}
.block-color-orange_background {
	background: rgb(250,235,221);
}
.block-color-yellow_background {
	background: rgb(251,243,219);
}
.block-color-teal_background {
	background: rgb(221,237,234);
}
.block-color-blue_background {
	background: rgb(221,235,241);
}
.block-color-purple_background {
	background: rgb(234,228,242);
}
.block-color-pink_background {
	background: rgb(244,223,235);
}
.block-color-red_background {
	background: rgb(251,228,228);
}

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="bd931592-2d9c-489a-9c33-ad5616c9c06a" class="page sans"><header><h1 class="page-title"><strong>Introducing Layers</strong></h1></header><div class="page-body"><p id="5940a9c3-57ac-4080-ad68-5285328f1980" class=""><strong>Table of Contents</strong><div class="indented"><nav id="e9dde693-2b26-431a-a49d-f2ec875b064c" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#f9edce3c-052f-4b17-a112-c138d41d723f"><strong>What is a layer?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#d64081c3-a0ac-49f5-93d4-2a58e386adc1"><strong>Unit layer</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#7d1928d3-518f-4291-a6c3-221b3d54410a"><strong>Composite layers</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#7a7365ad-5a12-4144-a09c-872acc57924c"><strong>Data</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#b2e3b34c-d068-40aa-afe9-bddeae3c7f20"><strong>Single layers with marks</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#3898198d-6ca5-4f91-8bf3-076e680bb1c6"><strong>Bar Layer</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#363dd7d7-f47a-40eb-8889-a6252ad76453"><strong>Line Layer</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#f406c3a4-7708-420b-8e3b-4f19bb01ee52"><strong>Area Layer</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#a8948d50-c305-4258-9a5d-5d1dd8ed1c70"><strong>Point Layer</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#77a11ffd-4a7b-47bd-94eb-8f9cecbebc74"><strong>Text Layer</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#b7e6abdf-8603-49ce-b434-5e2f32cc66fa"><strong>Tick Layer</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#f5c2989b-e380-4da1-83be-31eaa82fec75"><strong>Arc Layer</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#0ad60405-0051-4b05-90fb-a4e3c6dfae96"><strong>Mark overriding</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#6b6d70c7-335f-4508-b7b4-0ddd3e06a895"><strong>Layer encodings</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#363cad8d-6e65-4707-9d19-6fa83b37070a"><strong>Wrapping up</strong></a></div></nav></div></p><hr id="aefdec0c-ef0c-426d-adf7-91a7530cd826"/><p id="5100c31e-a693-4e69-b1c8-0fcbbd820e94" class="">We have reiterated the fact that Muze is a composable library. As such, the most basic composability comes from building complex charts as easily as possible and the extensibility of these charts. In order to establish this, Muze allows you to compose layers on top of one another and link them together to create interactive visualization.</p><p id="d0a86e0f-c897-4705-9508-f69245e960a6" class="">But first, let us understand what we mean by layers.</p><h2 id="f9edce3c-052f-4b17-a112-c138d41d723f" class=""><strong>What is a layer?</strong></h2><p id="6a01d27c-27e4-4752-82c2-f16c9dc00835" class="">A layer is a visualization of <strong>data points</strong> with <strong>mark</strong> and <strong>encodings</strong> applied on it. Planer encoding (x, y) position the points in 2D plane and retinal encoding (color, shape, size) changes visual representation of the points based on value of some variable. So it is safe to say</p><p id="0191b03c-22da-491e-b85f-110e423ceef4" class=""><em><mark class="highlight-blue_background">layer = data + mark</mark></em></p><p id="44387c91-f58a-4fa3-9199-6237bce3f5a3" class=""><strong>Marks</strong> are analogous to <strong>plot types</strong> we have heard in other visualization libraries.</p><p id="96726ed9-ec14-486e-afcf-da8eb7c67676" class="">Muze provides atomic marks which you can use to compose layers. Following are the marks available in Muze</p><ul id="64665330-745a-4592-898f-129e47b82fbb" class="bulleted-list"><li>Bar</li></ul><ul id="c6a8bd6f-b816-4692-af50-77e32a07d7b4" class="bulleted-list"><li>Line</li></ul><ul id="44b1f15b-c9b1-4160-bc0b-eff895a6f700" class="bulleted-list"><li>Area</li></ul><ul id="da5152ca-24db-4d1c-ad7b-0efd29345b7f" class="bulleted-list"><li>Arc</li></ul><ul id="b91f0b32-22d0-438c-917a-4ba3f3eb0b56" class="bulleted-list"><li>Text</li></ul><ul id="7900583b-190f-4c00-ac7a-faa01f4af546" class="bulleted-list"><li>Dot</li></ul><ul id="31e0f2d2-7ad7-4c9a-8988-404727dfc59e" class="bulleted-list"><li>Tick</li></ul><h3 id="d64081c3-a0ac-49f5-93d4-2a58e386adc1" class=""><strong>Unit layer</strong></h3><p id="de8d4507-793e-48d8-b288-cdf4f9f32a3a" class="">Lets take an example of a simple bar plot</p><figure id="877144e1-916b-4ba9-8146-64e0a07c06d6" class="image"><a href="https://muzejs.org/static/docs_images/composing-layers/1.png"><img src="https://muzejs.org/static/docs_images/composing-layers/1.png"/></a></figure><p id="c4c1b283-a93e-4dee-8b52-357626287a83" class="">Here there is only one layer rendered to house the <em>data points</em> with <em>bar mark</em> with planer encoding. If you see the code for the layer it would look something like</p><pre id="55f60091-8ff4-4bad-a6e9-3fecd47dc2a9" class="code"><code>canvas.layers([{
    mark: &#x27;bar&#x27;,
    encoding: {
        y: &#x27;Horsepower&#x27;,
        x: &#x27;Origin&#x27;
    }
}])</code></pre><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="34b1e6ec-e667-4809-99ff-1ee2c3ff1766"><div style="font-size:1.5em"><span class="icon">⚠️</span></div><div style="width:100%"><mark class="highlight-yellow"><strong>Muze generates default definition of layers
</strong></mark>You don&#x27;t have to define a layer always, Muze generates layers&#x27; definition based on fields mapped to <code>rows</code> and <code>columns</code> and type of the fields (measure and dimension)</div></figure><h3 id="7d1928d3-518f-4291-a6c3-221b3d54410a" class=""><strong>Composite layers</strong></h3><p id="bc71e4fa-b365-4897-96f9-73625372303f" class="">Lets take the example of the visualization from <mark class="highlight-blue"><a href="https://muzejs.org/docs/Trendlines">trend line tutorial</a></mark>.</p><figure id="216a73ba-ea37-49c8-9878-d7631f814f30" class="image"><a href="https://muzejs.org/static/docs_images/composing-layers/2.png"><img src="https://muzejs.org/static/docs_images/composing-layers/2.png"/></a></figure><p id="1cf6fb51-8108-4952-b6de-2a5004f817be" class="">If you dissect the above visualization, you find out there are two layers, one for the bar chart, lets call it <strong>bar layer</strong> and another for the line and text, lets call it <strong>trendline layer</strong> where bar layer and trendline layer sit on top of each other.</p><p id="242401d2-d052-40f7-966e-3aa7ed57c54e" class="">You might be thinking why have we grouped both line and text to create one trendline layer, we could have created individual layers for both of them. If you think logically, line and text together form the trendline layer. They can&#x27;t exist individually. That&#x27;s why one layer to handle both of them.</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="b06e451e-b204-4da7-bd29-eb2c2d8ad863"><div style="font-size:1.5em"><span class="icon">✅</span></div><div style="width:100%"><strong><mark class="highlight-teal">Layers are like svg groups
</mark></strong>If you have used svg groups ( <code>&lt;g&gt; ... &lt;/g&gt;</code> ) before, you might remember you create a group for one logical section and form a hierarchy.
    <mark class="highlight-blue_background">g
    |---rect
    |---g
        | --- text
        | --- text</mark>

Muze&#x27;s layers are exactly similar to this concept
    <mark class="highlight-blue_background">composed-layer-2
    |---bar
    |---composed-layer-1
        | --- line
        | --- text</mark></div></figure><h2 id="7a7365ad-5a12-4144-a09c-872acc57924c" class=""><strong>Data</strong></h2><p id="c7cea182-1a68-44de-a22c-85ee6db0d305" class="">We will be using <mark class="highlight-blue"><a href="https://muzejs.org/static/cars.json">cars.json</a></mark><mark class="highlight-blue"> </mark>data for illustration.</p><h2 id="b2e3b34c-d068-40aa-afe9-bddeae3c7f20" class=""><strong>Single layers with marks</strong></h2><p id="3ccccbdc-65c8-48a7-835c-455757899928" class="">Lets create unit layers with default marks provided by Muze</p><h3 id="3898198d-6ca5-4f91-8bf3-076e680bb1c6" class=""><strong>Bar Layer</strong></h3><p id="778d256f-f474-45cd-8e57-7635eff2c102" class="">A bar layer is made up of rectangular bars. They are useful when the data has a categorical (<mark class="highlight-blue"><a href="https://muzejs.org/docs/introduction-to-datamodel#dimension">dimension</a></mark>) field against a <mark class="highlight-blue"><a href="https://muzejs.org/docs/introduction-to-datamodel#measure">measure</a></mark> field. The alignment (horizontal / vertical) of the bars are determined from which type of variable is mapped to x and y axis.</p><p id="3f0f4d49-dc33-4e52-a4bd-d67e8c55125f" class=""><em>Let&#x27;s consider we need to see how powerful the cars for the different countries are:</em></p><figure id="667e5df7-d951-46e4-855f-1507cbf0cfad" class="image"><a href="https://muzejs.org/static/images/copy.svg"><img style="width:36px" src="https://muzejs.org/static/images/copy.svg"/></a></figure><pre id="4f386b13-01fd-4b61-9e65-97f841e66254" class="code"><code>// DataModel instance is created from https://muzejs.org/static/cars.json data,
// https://muzejs.org/static/cars-schema.json schema and assigned to variable dm.

const env = muze();
const canvas = env.canvas();

canvas
    .data(dm)
    .width(600)
    .height(400)
    .rows([&#x27;Horsepower&#x27;])
    .columns([&#x27;Origin&#x27;])
    .mount(&#x27;#chart-container&#x27;);</code></pre><p id="1e7c8a66-045a-4978-b923-4a33c8dc55b5" class="">Although we have not mentioned what kind of chart to be displayed, Muze based on the type of field getting assigned to <code>rows</code> and <code>columns</code> creates a visualization with one layer with mark bar. If you want to know Muze chooses the default mark for a rendering, check <mark class="highlight-blue"><a href="https://muzejs.org/docs/introduction-to-muze#putting-it-all-together">this table</a></mark> out.</p><p id="39dac4cb-ecfe-4ece-b983-c6e6216bf92a" class="">By adding colors, we can <code>stack</code> or <code>group</code> the bars. Let&#x27;s see how powerful the different cars are by <em>Cylinder</em> for each country:</p><figure id="fd1017c4-7e65-4c8a-b513-cca245f1cfbc" class="image"><a href="https://muzejs.org/static/images/copy.svg"><img style="width:48px" src="https://muzejs.org/static/images/copy.svg"/></a></figure><pre id="3819815a-37c2-44ed-8c84-5eef992ae3b9" class="code"><code>// DataModel instance is created from https://muzejs.org/static/cars.json data,
// https://muzejs.org/static/cars-schema.json schema and assigned to variable dm.
  
const env = muze();
const canvas = env.canvas();
  
canvas
    .data(dm)
    .width(600)
    .height(400)
    .rows([&#x27;Horsepower&#x27;])
    .layers([{
    	mark: &#x27;bar&#x27;, 
      	transform: {
        	type:&#x27;group&#x27;
     	}
    }])
    .columns([&#x27;Origin&#x27;])
    .color(&#x27;Cylinders&#x27;)
    .mount(&#x27;#chart-container&#x27;);</code></pre><p id="a945159e-c4e2-4080-9f08-59fba79826b4" class="">When a field is assigned to <code>color</code> is assigned to encoding channel, it helps us encode more information in a visualization. We assigned <em>Cylinders</em> to <code>color</code>encoding channel and notice how we got one colored bar for each cylinders.</p><p id="6a17a27a-62c7-4a2d-9402-48666ad4bba7" class="">With this new details of data by default <code>stack</code> transformed is used by Muze to show the visualization. But here we choose to see <code>group</code> transformation using.</p><pre id="ca288120-5820-4f45-a92a-0cd573b9f1d8" class="code"><code>.layers([{
    mark: &#x27;bar&#x27;, 
    transform: {
        type:&#x27;group&#x27;
    }
}])</code></pre><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="e778eff1-dfae-4fe6-9492-1b6514879b28"><div style="font-size:1.5em"><span class="icon">⚠️</span></div><div style="width:100%"><strong><mark class="highlight-yellow">Not all data is suitable for stack transform
</mark></strong>Of course, You can change value of the <code>transform</code> property from <code>group</code></div></figure><pre id="ecc0139e-97a1-44aa-b148-f57f54ae7091" class="code"><code>.layers([{
    mark: &#x27;bar&#x27;,
    transfrom: {
        type: &#x27;stack&#x27;
    }
}])</code></pre><p id="c2082fb6-4aba-4af7-a140-73f7f6402945" class="">But you cant make sense anything from the chart you will get for stack transfrom here.</p><p id="77bab496-a5a2-457d-84d5-caddead70f86" class="">Checkout <mark class="highlight-blue"><a href="https://muzejs.org/examples/view/stacked-bar-chart-the6mqxwz">this example</a></mark> where we calculate data for stack transform and then show a proper stacked chart.</p><h3 id="363dd7d7-f47a-40eb-8889-a6252ad76453" class=""><strong>Line Layer</strong></h3><p id="897048aa-2412-4cb6-a901-6b41a5670365" class="">A line layer is made up of path. They are useful to check patterns and exceptions in data which has sequential progression, like time. It forms the basis of a line chart. Muze automatically creates a line layer if you assign temporal (<mark class="highlight-blue"><a href="https://muzejs.org/docs/introduction-to-datamodel#dimension">dimension</a></mark>) field to either of the axes</p><p id="7b0d624b-a224-4942-9ef8-91fd5b7c2591" class=""><em>Let&#x27;s check whether the Acceleration of the cars manufactured have actually become better over the time</em></p><figure id="1b513c3c-49f3-40f7-805f-980817886e28" class="image"><a href="https://muzejs.org/static/images/copy.svg"><img style="width:48px" src="https://muzejs.org/static/images/copy.svg"/></a></figure><pre id="52166b93-c3f7-46af-acda-60a5a0f24893" class="code"><code>// DataModel instance is created from https://muzejs.org/static/cars.json data,
// https://muzejs.org/static/cars-schema.json schema and assigned to variable dm.
  
const env = muze();
const canvas = env.canvas();

canvas
    .data(dm)
    .width(600)
    .height(400)
    .rows([&#x27;Acceleration&#x27;])
    .columns([&#x27;Year&#x27;])
    .mount(&#x27;#chart-container&#x27;);</code></pre><p id="4c2fdd19-77b3-41c3-876f-99c80021d51b" class="">In the above chart we have not mentioned anywhere to draw a line chart. But Muze figured out that <em>Year</em> is a temporal field (which you have <mark class="highlight-blue"><a href="https://muzejs.org/docs/static/cars-schema.json">described</a></mark> in <mark class="highlight-blue"><a href="https://muzejs.org/docs/api-schema">schema</a></mark> of <mark class="highlight-blue"><a href="https://muzejs.org/docs/introduction-to-datamodel#dimension">DataModel</a></mark><a href="https://muzejs.org/docs/introduction-to-datamodel#dimension"> </a>) in <mark class="highlight-blue"><a href="https://muzejs.org/static/cars.json">data</a></mark> and <em>Year</em> is assigned in x-axis (<code>columns</code>), so it generates the following config internally</p><pre id="df3b51a2-9350-4df7-aef5-5784c993eba2" class="code"><code>canvas.layer([{
    mark: &#x27;line&#x27;,
    encoding: {
        x: &#x27;Year&#x27;,
        y: &#x27;Acceleration&#x27;
    }
}])</code></pre><h3 id="f406c3a4-7708-420b-8e3b-4f19bb01ee52" class=""><strong>Area Layer</strong></h3><p id="1e9213f8-2834-4b38-94b4-0806f885636b" class="">An area layer is similar to a line chart, except that it shows the volume of a <mark class="highlight-blue"><a href="https://muzejs.org/docs/introduction-to-datamodel#dimension">measure</a></mark> by area covered under the graph.</p><figure id="c01eef63-8e46-4118-a312-30202a6c2a92" class="image"><a href="https://muzejs.org/static/images/copy.svg"><img style="width:36px" src="https://muzejs.org/static/images/copy.svg"/></a></figure><pre id="2d9e752d-b1b3-46e3-b752-0595c4b3276b" class="code"><code>// DataModel instance is created from https://muzejs.org/static/cars.json data,
// https://muzejs.org/static/cars-schema.json schema and assigned to variable dm.
  
const env = muze();
const canvas = env.canvas();

canvas
    .data(dm)
    .width(600)
    .height(400)
    .layers([{
      	mark : &#x27;area&#x27;,
      	interpolate: &#x27;catmullRom&#x27; /* spline */
    }])
    .rows([&#x27;Weight_in_lbs&#x27;])
    .columns([&#x27;Year&#x27;])
    .mount(&#x27;#chart-container&#x27;);</code></pre><p id="f862ebec-a1a8-439c-b947-26b332adf900" class="">If you look at the chart above, you will see that the area chart is smooth, unlike the line plot. This is because we have add an interpolator <mark class="highlight-blue"><a href="https://www.cs.cmu.edu/~462/projects/assn2/assn2/catmullRom.pdf">catMullRom</a></mark> in layer to introduce the smoothness.</p><h3 id="a8948d50-c305-4258-9a5d-5d1dd8ed1c70" class=""><strong>Point Layer</strong></h3><p id="b23465df-0fce-4508-a2a1-532d8fceff30" class="">If <mark class="highlight-blue"><a href="https://muzejs.org/docs/introduction-to-datamodel#measure">measures</a></mark> are assigned to both of the axes, Muze renders a layer with point mark. Each point in the following chart can take any continuous value in x and y coordinate. It forms the basis of scatter and bubbles charts.</p><p id="84e3498e-6cb2-4b66-8f51-7cd29f73bcf0" class=""><em>Let&#x27;s see the Power to Weight Distribution of cars</em></p><figure id="07a4600c-9ba6-440e-80d5-62adf739e978" class="image"><a href="https://muzejs.org/static/images/copy.svg"><img style="width:60px" src="https://muzejs.org/static/images/copy.svg"/></a></figure><pre id="7f3e4bf4-aa7c-41ac-94dc-e7ea89256db5" class="code"><code>// DataModel instance is created from https://muzejs.org/static/cars.json data,
// https://muzejs.org/static/cars-schema.json schema and assigned to variable dm.
  
const env = muze();
const canvas = env.canvas();

canvas
    .data(dm)
    .width(600)
    .height(400)
    .rows([&#x27;Displacement&#x27;])
    .columns([&#x27;Origin&#x27;])
    .layers([{
    	mark : &#x27;text&#x27;,
      	encoding: {
        	text: {
            	field: &#x27;Horsepower&#x27;,
              	formatter: val =&gt; &#x27;Horsepower: &#x27; + parseFloat(val, 10).toFixed(2)
            }/* To display the text */
      	} 
    }])
    .mount(&#x27;#chart-container&#x27;);</code></pre><p id="da16315b-ce90-4e81-8a0f-447fb6fb139a" class="">Muze internally generates the following config to render the above layer</p><pre id="6ddcdb78-2a78-469f-83ed-790ecb567372" class="code"><code>canvas.layer([{
    mark: &#x27;point&#x27;,
    encoding: {
        x: &#x27;Horsepower&#x27;,
        y: &#x27;Weight_in_lbs&#x27;
    }
}])</code></pre><p id="541e57a4-6391-4849-8796-b0644b00bb70" class="">You can apply <code>color</code>, <code>shape</code> and <code>size</code> <mark class="highlight-blue"><a href="https://muzejs.org/docs/retinal-encoding">retinal encodings</a></mark> on point layer.</p><h3 id="77a11ffd-4a7b-47bd-94eb-8f9cecbebc74" class=""><strong>Text Layer</strong></h3><p id="d1da6c54-2057-4013-8f5e-a24cff086118" class="">A layer with mark text draws text. Muze by default does not show any annotations (text) on a plot. If you need text labels on charts, you have to add this layer along side bar layer.</p><figure id="cc844e09-6ffa-49bf-bb29-8d53712aa68a" class="image"><a href="https://muzejs.org/static/images/copy.svg"><img style="width:72px" src="https://muzejs.org/static/images/copy.svg"/></a></figure><pre id="3eb1b7a2-c62b-4a91-af21-e97ce2337319" class="code"><code>// DataModel instance is created from https://muzejs.org/static/cars.json data,
// https://muzejs.org/static/cars-schema.json schema and assigned to variable dm.
  
const env = muze();
const canvas = env.canvas();

canvas
    .data(dm)
    .width(600)
    .height(400)
    .rows([&#x27;Displacement&#x27;])
    .columns([&#x27;Origin&#x27;])
    .layers([{
    	mark : &#x27;text&#x27;,
      	encoding: {
        	text: {
            	field: &#x27;Horsepower&#x27;,
              	formatter: val =&gt; &#x27;Horsepower: &#x27; + parseFloat(val, 10).toFixed(2)
            }/* To display the text */
      	} 
    }])
    .mount(&#x27;#chart-container&#x27;);</code></pre><p id="70903abc-52bd-4ffb-8ffc-954d8195a584" class="">We have done couple of more things than just rendering a text layer. We have formatted the value of the text by using <code>formatter</code> property.</p><p id="75d416d8-7a78-4611-9ae9-39f6aace28ca" class="">Also notice the x-position of the text is determined by <em>Origin</em> and y-position is determined by <em>Displacement</em> but we are showing the value of <em>Horsepower</em> in the chart.</p><p id="bf42788c-4a97-4025-8681-2238a05dad75" class="">When we provide <code>encoding</code> in layers we just assign the field name to a particular encoding like</p><pre id="f991910d-2ad2-419c-86da-5b7a1b49a350" class="code"><code>.layers([{
    mark: &#x27;text&#x27;,
    encoding: {
        text: &#x27;Horsepower&#x27;
    }
}])</code></pre><p id="467291b1-9e40-40b7-bffc-2feaf09531e4" class="">The above config is a shorthand for</p><pre id="dd173783-e364-4dfa-80cd-bb3814642ff3" class="code"><code>.layers([{
    mark: &#x27;text&#x27;,
    encoding: {
        text: {
            field: &#x27;Horsepower&#x27;,
            /* additional properties */
        }
    }
}])</code></pre><h3 id="b7e6abdf-8603-49ce-b434-5e2f32cc66fa" class=""><strong>Tick Layer</strong></h3><p id="80a8006a-b753-4320-897c-263050514072" class="">A tick is largely similar to a point mark except for the fact that it has a start point and an end point and thus is always a straight line.</p><h3 id="f5c2989b-e380-4da1-83be-31eaa82fec75" class=""><strong>Arc Layer</strong></h3><p id="3a1d6742-1423-4a1b-862c-7a15e3381b52" class="">The arc layer is the most different of all the layers, in that it does not follow (x,y) cartesian coordinate system, rather it uses the polar coordinates. By dividing a circular structure, it provides the basis of charts like pie chart, donut chart etc. Arc layer has different encodings altogether. Since this layer comes from polar coordinate the planer encodings are <code>radius</code> and <code>angle</code>.</p><p id="02335979-3c7e-424b-b2a0-866d44153150" class="">Checkout <mark class="highlight-blue"><a href="https://muzejs.org/examples/view/radial-pie-oakntjm9t">this example</a></mark> of an arc chart.</p><h2 id="0ad60405-0051-4b05-90fb-a4e3c6dfae96" class=""><strong>Mark overriding</strong></h2><p id="cd183783-492f-40c2-98e1-b407f491b411" class="">Based on the variable type (<mark class="highlight-blue"><a href="https://muzejs.org/docs/introduction-to-datamodel#providing-the-schema-of-the-data-to-datamodel">measure or dimension</a></mark>) assigned to x axis and y axis (<code>rows</code> and <code>columns</code>) Muze decides the mark type from <mark class="highlight-blue"><a href="https://muzejs.org/docs/introduction-to-muze#using-the-environment">this lookup table</a></mark>.</p><p id="6a436320-901a-49e1-8e3b-a18a37e22a9d" class="">How ever you can override the choice Muze has done for you easily.</p><p id="b51a0517-5911-43dc-b5c4-de597acbe5bd" class="">Lets say you want to show a bar chart to visualize how weight of a car has changed over the time.</p><figure id="e1e0feb2-9cda-46af-96e6-c7e525d59236" class="image"><a href="https://muzejs.org/static/images/copy.svg"><img style="width:60px" src="https://muzejs.org/static/images/copy.svg"/></a></figure><pre id="9a4ecc01-a4d5-4cb6-9937-9a94c29c7cf4" class="code"><code>// DataModel instance is created from https://muzejs.org/static/cars.json data,
// https://muzejs.org/static/cars-schema.json schema and assigned to variable dm.
  
const env = muze();
const canvas = env.canvas();

canvas
    .data(dm)
    .width(600)
    .height(400)
    .layers([{
      	mark : &#x27;bar&#x27;
    }])
    .rows([&#x27;Weight_in_lbs&#x27;])
    .columns([&#x27;Year&#x27;])
    .mount(&#x27;#chart-container&#x27;);</code></pre><p id="ecf34250-00b0-47c6-a43a-263a75a7776b" class="">As you can see, all we have done is, defined the layer ourself and then passed it to Muze.</p><pre id="6ba30f3e-4a39-4708-8a35-fb3137d8b9f2" class="code"><code>.layers([{
   mark : &#x27;bar&#x27;
}])</code></pre><p id="5e948046-0509-4a0d-aef3-13f8c8808ed5" class="">If you go ahead and remove the layer function, you will see Muze by default renders a line layer, because it generates the following config if you dont pass the layer definition</p><pre id="d08c1b19-d9aa-4816-a1f7-bb93de3ae72f" class="code"><code>.layers([{
   mark : &#x27;line&#x27;,
   encoding: {
       x: &#x27;Year&#x27;,
       y: &#x27;Weight_in_lbs&#x27;
   }
}])</code></pre><p id="8c361eba-06c7-47fb-9aef-026cecbe80cf" class="">Also note, in the code for above example, we have not given <code>encoding</code> explicitly in <code>layer</code> function. In this case also, Muze automatically populates <code>encoding</code> object from <code>rows</code> and <code>columns</code>.</p><h2 id="6b6d70c7-335f-4508-b7b4-0ddd3e06a895" class=""><strong>Layer encodings</strong></h2><p id="2959cdb4-065e-45e2-8ff1-2e5a7f542a45" class="">We have only seen few of the encodings which a layer with a particular mark supports. There are few more of these which we have not discussed. The following table shows the supported encoding for each layer with particular mark.</p><figure id="63bf81d7-1275-497a-bb8f-b2fa7565c9d8" class="image"><a href="https://muzejs.org/static/docs_images/composing-layers/3.png"><img src="https://muzejs.org/static/docs_images/composing-layers/3.png"/></a></figure><p id="d9869045-03d8-450c-bd40-0ef9040cffce" class="">Arc layer does not support <code>x</code>, <code>x0</code>, <code>y</code>, <code>y0</code> encoding. It supports <code>radius</code>, <code>angle</code>, <code>color</code>, <code>size</code> encoding.</p><p id="c4238f8f-5e72-4312-8cf3-0f16a66b8caf" class="">Let&#x27;s see what happens if you give y and y0 encoding to area plot.</p><figure id="b4ae7918-91da-44e5-8905-705f212dbe6d" class="image"><a href="https://muzejs.org/static/images/copy.svg"><img style="width:48px" src="https://muzejs.org/static/images/copy.svg"/></a></figure><pre id="a6da8e19-9813-41fc-b39e-b551e94f60b8" class="code"><code>// DataModel instance is created from https://muzejs.org/static/cars.json data,
// https://muzejs.org/static/cars-schema.json schema and assigned to variable dm.

dm = dm.calculateVariable({
    name: &#x27;min_weight&#x27;,
    type: &#x27;measure&#x27;,
    defAggFn: &#x27;min&#x27;
}, [&#x27;Weight_in_lbs&#x27;, val =&gt; val]); // Max value of weight for a group

dm = dm.calculateVariable({
    name: &#x27;max_weight&#x27;,
    type: &#x27;measure&#x27;,
    defAggFn: &#x27;max&#x27;
}, [&#x27;Weight_in_lbs&#x27;, val =&gt; val]); // Min value of weight for a group

const share = muze.Operators.share;
const env = muze();
const canvas = env.canvas();

canvas
    .data(dm)
    .width(600)
    .height(400)
    .layers([{
          mark : &#x27;area&#x27;,
          interpolate: &#x27;catmullRom&#x27;, /* spline */
          encoding: {
            y: &#x27;max_weight&#x27;,
            y0: &#x27;min_weight&#x27;,
            color: { value: () =&gt; &#x27;#ff9800&#x27;}
        }
    }])
    .rows([[share(&#x27;max_weight&#x27;, &#x27;min_weight&#x27;) /* create a shared varaibles to be plotted on same axis */]])
    .columns([&#x27;Year&#x27;])
    .mount(&#x27;#chart-container&#x27;);</code></pre><p id="b71f01c9-8c7e-4f37-b482-2ef6954a9b8d" class="">And that&#x27;s how easily a range area plot can be created using simple layers.</p><h2 id="363cad8d-6e65-4707-9d19-6fa83b37070a" class=""><strong>Wrapping up</strong></h2><p id="b0898364-c9a2-46f4-8af3-540104651913" class="">By now, you probably have a basic idea of what we are trying to establish here. Let&#x27;s go about it:</p><ul id="b0f66cff-6917-45c7-9759-680099a2f01d" class="bulleted-list"><li>Muze creates default layers for specific field type combinations</li></ul><ul id="d7361be9-4be7-46f2-b8f4-c15b8a0481db" class="bulleted-list"><li>You can override these layers by providing your own layer configurations including marks and encodings</li></ul><ul id="001907fb-02a8-47b0-bad7-c749be1e4a92" class="bulleted-list"><li>Muze automatically takes the encodings for the layers if you we specify</li></ul><ul id="e21890fb-1db2-4509-9f2c-d8d77e48146b" class="bulleted-list"><li>Muze allows multiple field to share one axis and create range plot</li></ul><p id="b95acac5-5db2-4557-b94d-5285718c2b3b" class="">If you are comfortable with the idea of layer, head to <mark class="highlight-blue"><a href="https://muzejs.org/docs/composing-layers">composing layers</a></mark> to understand how layer makes a visualization rich.</p></div></article></body></html>