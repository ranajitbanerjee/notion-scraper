<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Registering Side Effects</title><style>
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark-href {
	font-size: 0.75em;
	opacity: 0.5;
}

.sans { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, KaiTi, STKaiTi, '华文楷体', KaiTi_GB2312, '楷体_GB2312', serif; }
.mono { font-family: Nitti, 'Microsoft YaHei', '微软雅黑', monospace; }
.pdf .sans { font-family: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC', 'Noto Sans CJK KR'; }

.pdf .code { font-family: Source Code Pro, 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC', 'Noto Sans Mono CJK KR'; }

.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, KaiTi, STKaiTi, '华文楷体', KaiTi_GB2312, '楷体_GB2312', serif, 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC', 'Noto Sans CJK KR'; }

.pdf .mono { font-family: PT Mono, Nitti, 'Microsoft YaHei', '微软雅黑', monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC', 'Noto Sans Mono CJK KR'; }

.highlight-default {
}
.highlight-gray {
	color: rgb(155,154,151);
}
.highlight-brown {
	color: rgb(100,71,58);
}
.highlight-orange {
	color: rgb(217,115,13);
}
.highlight-yellow {
	color: rgb(223,171,1);
}
.highlight-teal {
	color: rgb(15,123,108);
}
.highlight-blue {
	color: rgb(11,110,153);
}
.highlight-purple {
	color: rgb(105,64,165);
}
.highlight-pink {
	color: rgb(173,26,114);
}
.highlight-red {
	color: rgb(224,62,62);
}
.highlight-gray_background {
	background: rgb(235,236,237);
}
.highlight-brown_background {
	background: rgb(233,229,227);
}
.highlight-orange_background {
	background: rgb(250,235,221);
}
.highlight-yellow_background {
	background: rgb(251,243,219);
}
.highlight-teal_background {
	background: rgb(221,237,234);
}
.highlight-blue_background {
	background: rgb(221,235,241);
}
.highlight-purple_background {
	background: rgb(234,228,242);
}
.highlight-pink_background {
	background: rgb(244,223,235);
}
.highlight-red_background {
	background: rgb(251,228,228);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(55, 53, 47, 0.6);
	fill: rgba(55, 53, 47, 0.6);
}
.block-color-brown {
	color: rgb(100,71,58);
	fill: rgb(100,71,58);
}
.block-color-orange {
	color: rgb(217,115,13);
	fill: rgb(217,115,13);
}
.block-color-yellow {
	color: rgb(223,171,1);
	fill: rgb(223,171,1);
}
.block-color-teal {
	color: rgb(15,123,108);
	fill: rgb(15,123,108);
}
.block-color-blue {
	color: rgb(11,110,153);
	fill: rgb(11,110,153);
}
.block-color-purple {
	color: rgb(105,64,165);
	fill: rgb(105,64,165);
}
.block-color-pink {
	color: rgb(173,26,114);
	fill: rgb(173,26,114);
}
.block-color-red {
	color: rgb(224,62,62);
	fill: rgb(224,62,62);
}
.block-color-gray_background {
	background: rgb(235,236,237);
}
.block-color-brown_background {
	background: rgb(233,229,227);
}
.block-color-orange_background {
	background: rgb(250,235,221);
}
.block-color-yellow_background {
	background: rgb(251,243,219);
}
.block-color-teal_background {
	background: rgb(221,237,234);
}
.block-color-blue_background {
	background: rgb(221,235,241);
}
.block-color-purple_background {
	background: rgb(234,228,242);
}
.block-color-pink_background {
	background: rgb(244,223,235);
}
.block-color-red_background {
	background: rgb(251,228,228);
}

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style><link rel="stylesheet" href="/static/iframe-docs/css/github.css"><link rel="stylesheet" href="/static/iframe-docs/css/style.css"><script src="/static/iframe-docs/js/highlight.pack.js"></script><script src="/static/iframe-docs/js/test.js"></script></head><body><article id="f2415412-5eca-4b3c-af54-cba4ac8e0180" class="page sans"><header><h1 class="page-title"><strong>Registering Side Effects</strong></h1></header><div class="page-body"><p id="99f80455-399a-4979-9c7f-884b400c7ca8" class><strong>Table of Contents</strong></p><div class="indented"><nav id="d2a516f2-8daf-4330-a35c-253faf64b5e5" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#a9b727ca-f8ae-42e8-aedf-51bb0e03b289"><strong>How to register a Sideeffect?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#a0e06d95-318f-4d31-92b0-2178e03be718"><strong>Registering a Spawnable Side Effect</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#1be36148-b115-49fb-8312-18b1a250bf8f"><strong>Getting the base class</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#7404488e-65ff-4c78-b1a1-3bfa063f0179"><strong>Using the base class to create a new side effect</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#3adecc73-c9ec-46fe-b6c4-8130b3dc1bf4"><strong>Using the side effect properties</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#8d8217b8-2eac-481e-a17e-27ff42e9027a">Getting the DataModel</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#33fc3516-8926-4283-89f0-35d6a1846a91">Getting the Drawing Context</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#67d8ed1e-1cf8-4369-87f5-6c32969c43b2"><strong>Applying the side effect</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#84bf8ddd-4e3d-4b0f-a3e2-31b9210f7d68"><strong>Registering a Surrogate Side Effect</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#730aee9d-01a1-498b-a253-6eb440c86725"><strong>Getting the base class</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#f915fad4-0c8e-4976-b8b3-8728484fcf11"><strong>Using the base class to create a new side effect</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#1b91d10a-b8d0-4b5c-8f68-67d694cc75f3"><strong>Using the side effect properties</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#53ab9fd9-79c7-4c8a-8939-5976c862a0d5">Getting the Selection and Rejection sets</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#9981deac-74c6-4945-afc8-c9bedde3c364">Getting the context</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#bcedef75-c3f0-4336-a6ce-ffcfb007b8d6"><strong>Applying the side effect</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#af607ed8-b230-46d9-9201-35d027780862">Getting plot elements from set</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#d9f9c1bc-f4f8-40d7-a924-871b74123976">Applying desired styles and/or attributes</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#66b4035d-070b-4179-afd6-94de6f7ba696"><strong>Wrapping Up</strong></a></div></nav></div><p></p><hr id="7bbf019e-a148-4426-a2b2-fce217c9067f"><p id="e26c533c-e3e3-4c9d-a183-1f2b9a50051d" class>In this section, we will learn about registering custom side effects. By registering our own side effects we can have any kind of visual change we need when the associated behaviour changes.</p><p id="a45f456f-7fe7-4635-b905-7aefd801dcd7" class>Let us understand more about registering side effects using the&#xA0;<mark class="highlight-blue"><a href="https://muzejs.org/static/cars.json">cars.json</a></mark>&#xA0;data.</p><h2 id="a9b727ca-f8ae-42e8-aedf-51bb0e03b289" class><strong>How to register a Sideeffect?</strong></h2><p id="d0380b15-c154-469b-8ba5-71a6ac76b23d" class>We can register a side effect by extending the&#xA0;<strong>Spawnable Side Effect</strong>&#xA0;or the&#xA0;<strong>Surrogate Side Effect</strong>&#xA0;and defining our own side effect.</p><p id="875b3cdb-5cf4-4608-9b80-8a3961a57b53" class>To recall,</p><ul id="0dc3d233-8c0f-4e80-a956-03efef39f1a9" class="bulleted-list"><li>A&#xA0;<strong>Spawnable Side Effect</strong>&#xA0;is an effect which creates/removes elements from the visualization(the context)</li></ul><ul id="d53bfebd-58c2-4747-bb00-ef0256f9e9ba" class="bulleted-list"><li>A&#xA0;<strong>Surrogate Side Effect</strong>&#xA0;is an effect which modifies elements present in the visualization but doesn&apos;t add/remove DOM elements</li></ul><p id="6c6a7d30-752b-4809-a62c-64b87da23806" class>We will see how we can register both of them separately</p><h2 id="a0e06d95-318f-4d31-92b0-2178e03be718" class><strong>Registering a Spawnable Side Effect</strong></h2><p id="08d18474-78b4-496c-8f55-ddf7f2363bef" class>Registering a spawnable sideeffect allows to add/remove elements from the canvas.</p><h3 id="1be36148-b115-49fb-8312-18b1a250bf8f" class><strong>Getting the base class</strong></h3><p id="5edccd89-1456-440c-a108-e819acdb9ae6" class>We can register a Spawnable Side Effect by extending the<code>SpawnableSideEffect</code>&#xA0;class in Muze. This base class contains the properties required for us to register a Spawnable Side Effect :</p><pre id="1f0ce0c6-7278-48bb-b427-cc469c2d0aab" class="code"><code>SpawnableSideEffect = Muze.SideEffects.standards.SpawnableSideEffect</code></pre><p id="36623508-1c47-408c-a3a3-10388460520e" class>We also need the&#xA0;<code>ActionModel</code>&#xA0;which handles the interaction model for Muze:</p><pre id="7991db22-5bbf-4338-b612-684b3883c3cc" class="code"><code>const ActionModel = muze.ActionModel</code></pre><h3 id="7404488e-65ff-4c78-b1a1-3bfa063f0179" class><strong>Using the base class to create a new side effect</strong></h3><p id="e19055f5-f7a8-4735-99a8-82f604defbc6" class>We will understand how to create a new spawnable side effect by registering a new side effect that displays the set of selected values whenever anything is selected in the chart.</p><pre id="7542ebe5-babf-4e6d-b7c7-a305ad7a8216" class="code"><code>ActionModel
    .registerSideEffects(
            class TextSideEffect extends SpawnableSideEffect {
                 static formalName() {
                        return &apos;selection-text&apos;
                 }
            }
    )</code></pre><p id="e052ed18-a631-4865-ad97-c56dfdc37519" class>You start by creating a new class by extending the&#xA0;<code>SpawnableSideEffect</code>&#xA0;class. Here, we have created the&#xA0;<code>TextSideEffect</code>&#xA0;class.Thereafter, we have to give a formal name for the side effect so that we can uniquely identify it.</p><p id="d3c2d725-752a-44cf-b679-280b9a550ad2" class><strong>This formal name is very important as it identifies the side effect.</strong></p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="1066754e-7131-4cbb-91a1-35a2398dffa9"><div style="font-size:1.5em"><span class="icon">&#x1F4A1;</span></div><div style="width:100%"><strong><mark class="highlight-yellow">Note
</mark></strong>Every side effect created is a unique side effect and Muze only generates instances of that effect to put use everywhere in the canvas(es).</div></figure><h3 id="3adecc73-c9ec-46fe-b6c4-8130b3dc1bf4" class><strong>Using the side effect properties</strong></h3><p id="c63afde7-1a0e-428c-8049-b7a17401e010" class>Once we have the class, we need to add our own side effect implementation to this class. To do this, Muze provides a set of methods and utilities which are useful when applying the effect. All of these methods are avaialble in the&#xA0;<code>apply</code>&#xA0;method available from the base class. This is the method that is triggered whenever the behaviour attached to the side effect changes. Some of them are given below:</p><pre id="2bb59f3a-880b-4b93-94d7-f5154bdd9509" class="code"><code>ActionModel
.registerSideEffects(class TextSideEffect extends SpawnableSideEffect {
    static formalName() {
        return &apos;selection-text&apos;;
    }

    apply(selectionSet) {
    /* Getting the datamodel */
       const dataModel = selectionSet.mergedEnter.model;

    /* Getting the Drawing Context */
       const drawingContext = this.drawingContext();

    /* Getting the side effect drawing area */ 
       const sideEffectGroup = drawingContext.sideEffectGroup;

    /* Getting the html container of the drawing area */ 
       const htmlContainer = drawingContext.htmlContainer;

   }
})</code></pre><h3 id="8d8217b8-2eac-481e-a17e-27ff42e9027a" class>Getting the DataModel</h3><p id="3fe0bc64-a336-4c4e-a66f-8d864f8ae176" class>The base class,&#xA0;<code>SpawnableSideEffect</code>&#xA0;provides the&#xA0;<code>selectionSet</code>&#xA0;which can be used to create a side effect. This set contains all the different kinds of selection and rejection sets, i.e, New Entry, Old Entry, New Exit and Old Exit sets.</p><p id="355e6402-8222-4426-a323-04da65160e0e" class>Additionally, it also contains the&#xA0;<strong>Merged Enter</strong>&#xA0;and the&#xA0;<strong>Merged Exit</strong>&#xA0;sets, which are basically the selection and rejection sets respectively.</p><p id="023e4cfc-ad38-468f-afa3-f67fb2f3ed7d" class>In order to get the side effect, you need to&#xA0;<code>apply</code>&#xA0;it using the DataModel available in either of the sets available to you.</p><p id="68dbc0d5-9c1c-43dd-ae7a-66e93eaa1969" class>For our example, we&apos;ll use the DataModel for the&#xA0;<code>mergedEnter</code>&#xA0;entry set so that we always get all the values in the selection sets.</p><h3 id="33fc3516-8926-4283-89f0-35d6a1846a91" class>Getting the Drawing Context</h3><p id="d475e1d4-80d9-48c9-abbe-d6a72637c04e" class>Next, we&apos;ll get the drawing context, i.e., the context of the canvas where the sideeffect will be applied:</p><pre id="3ecf6699-45ac-4219-bb52-bf4c1a104b3c" class="code"><code>const drawingContext = this.drawingContext();</code></pre><p id="652ae35e-cb0a-4f4f-a313-0d9287d642d0" class>The drawing context contains the information of where in the canvas the side effect will be added to and where the html container containing the canvas lies. To use the side effect group, where the side effect can be added to, simply use it from the&#xA0;<code>drawingContext</code>:</p><pre id="5c0d83db-e625-4ef8-a263-d92e65c0a65b" class="code"><code>const sideEffectGroup = drawingContext.sideEffectGroup;</code></pre><h3 id="67d8ed1e-1cf8-4369-87f5-6c32969c43b2" class><strong>Applying the side effect</strong></h3><p id="398ed23a-28f9-4932-a81c-afaa7e351e74" class>Everytime the behaviour attached to this sideeffect changes( for our example, when we select values), the apply method applies this side effect. As such, on the behaviour change, we&apos;ll have access to the selection set and rejection sets and we can add/remove any elements from the visualization based on the information in these sets.</p><p id="d23b91b6-24c0-4351-915b-c5a3ec8f3adb" class>Here&apos;s an example where we&apos;ve added text to be appended every time the side effect is applied:</p><pre id="8eb40fdc-ab7c-43b0-ae5f-da52d9dd826f" class="code"><code>apply(selectionSet) {
       const dataModel = selectionSet.mergedEnter.model;
       const drawingContext = this.drawingContext();

       const textGroups = this.createElement(drawingContext.sideEffectGroup, &apos;text&apos;, [1]);

       /* createElement is a utility method for side effects */
       textGroups.html(`Selected:${dataModel.getData().data.map(e =&gt; e.join(&apos;, &apos;))}`);

       textGroups.attr(&apos;y&apos;, &apos;30&apos;);
       return this;
   }</code></pre><p id="2fae43f6-2215-4202-9e2a-9dfb3e0e8699" class>Here, we have appended a&#xA0;<code>text</code>&#xA0;element to the&#xA0;<code>sideEffectGroup</code>. The&#xA0;<code>this.createElement</code>&#xA0;is a utility function that enables you to create elements quickly.</p><p id="3abce232-f662-423e-8009-541c5d7cfe5a" class><strong>Note:</strong>&#xA0;This utility function makes use of d3 selections. So before you use it, please understand the&#xA0;<mark class="highlight-blue"><a href="https://bl.ocks.org/mbostock/3808218">General Update Pattern</a></mark>.</p><p id="f278b8b0-8315-4149-9af2-8b61ff6e2e6e" class>We have now registered a side effect and we need to map it in order to use it.</p><figure id="2936b00d-16f9-4849-8314-6e7cc744b77a"><div class="source"><iframe id="cp_embed_ZEYBqmQ" src="https://codepen.io/chartshq/embed/preview/ZEYBqmQ?height=600&amp;slug-hash=ZEYBqmQ&amp;default-tabs=js,result&amp;host=https://codepen.io&amp;editable=true" title="applying-side-effect" scrolling="no" frameborder="0" height="600" allowtransparency="true" class="cp_embed_iframe" style="width: 100%; overflow: hidden;"></iframe></div></figure><h2 id="84bf8ddd-4e3d-4b0f-a3e2-31b9210f7d68" class><strong>Registering a Surrogate Side Effect</strong></h2><p id="2c0ddee2-673e-4622-929f-8bc800e337ba" class>Registering a surrogate sideeffect allows to modify the elements present in the canvas.</p><h3 id="730aee9d-01a1-498b-a253-6eb440c86725" class><strong>Getting the base class</strong></h3><p id="6653d02d-e0e7-49dd-8ee3-db787b8807f7" class>We can register a Surrogate Side Effect by extending the&#xA0;<code>SurrogateSideEffect</code>&#xA0;class in Muze. This base class contains the properties required for us to register a Surrogate Side Effect :</p><pre id="7875bf55-f98d-494f-9871-94e19e04dc87" class="code"><code>SurrogateSideEffect = Muze.SideEffects.standards.SurrogateSideEffect</code></pre><p id="47d45b8d-a308-45ce-98bd-f32fcab6efa7" class>We also need the&#xA0;<code>ActionModel</code>&#xA0;which handles the interaction model for Muze:</p><pre id="1d384f91-f933-4847-a570-2cc9f29c6228" class="code"><code>const ActionModel = muze.ActionModel</code></pre><h3 id="f915fad4-0c8e-4976-b8b3-8728484fcf11" class><strong>Using the base class to create a new side effect</strong></h3><p id="e45e2b25-e2b2-4186-a96d-c0dd080cf3e9" class>We will understand how to create a new surrogate side effect by registering a new side effect that displays the set of selected values whenever anything is selected in the chart.</p><pre id="611719f9-8dea-4f07-9cc7-8fe96deebdc7" class="code"><code>ActionModel
    .registerSideEffects(
            class StrokeSideEffect extends SurrogateSideEffect {
                 static formalName() {
                        return &apos;stroke-effect&apos;
                 }
            }
    )</code></pre><p id="3a341fad-e5b2-4911-8b70-e59e575a5e36" class>You start by creating a new class by extending the&#xA0;<code>SurrogateSideEffect</code>&#xA0;class. Here, we have created the&#xA0;<code>StrokeSideEffect</code>&#xA0;class.Thereafter, we have to give a formal name for the side effect so that we can uniquely identify it.</p><p id="bcdd18c5-2888-4cd4-bb85-72cd164b976f" class><strong>This formal name is very important as it identifies the side effect.</strong></p><p id="660126f7-6f6b-448d-8f63-83cd0fae4d6e" class>
</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="a4aadfb3-ad1f-43ab-b311-94cd08df3c23"><div style="font-size:1.5em"><span class="icon">&#x1F4A1;</span></div><div style="width:100%"><mark class="highlight-yellow"><strong>Every side effect created is a unique side effect
</strong></mark>Every side effect created is a unique side effect and Muze only generates instances of that effect to put use every where in the canvas(es).</div></figure><h3 id="1b91d10a-b8d0-4b5c-8f68-67d694cc75f3" class><strong>Using the side effect properties</strong></h3><p id="78ca6473-4183-4520-abbb-6412fd70e023" class>Once we have the class, we need to add our own side effect implementation to this class. To do this, Muze provides a set of methods and utilities which are useful when applying the effect. All of these methods are avaialble in the&#xA0;<code>apply</code>&#xA0;method available from the base class. This is the method that is triggered whenever the behaviour attached to the side effect changes. Some of them are given below:</p><pre id="0258e7f1-fd93-4317-8077-c261f875ec3a" class="code"><code>ActionModel
.registerSideEffects(class StrokeSideEffect extends SurrogateSideEffect {
    static formalName() {
        return &apos;stroke-effect&apos;;
    }

    apply(selectionSet) {
       // Getting the selection and rejection sets
       const { completeSet, mergedExit, mergedEnter } = selectionSet;

      // Getting the context, i.e., each of the unit instances present in the canvas
       const context = this.firebolt.context;

      // Getting the set of  layers associated to a particular unit instance
       const layers = context.layers();
   }
})</code></pre><h3 id="53ab9fd9-79c7-4c8a-8939-5976c862a0d5" class>Getting the Selection and Rejection sets</h3><p id="85616ec3-51f1-4391-8dd7-6939190db50c" class>The base class,&#xA0;<code>SurrogateSideEffect</code>&#xA0;provides the&#xA0;<code>selectionSet</code>&#xA0;which can be used to create a side effect. This set contains all the different kinds of selection and rejection sets, i.e, New Entry, Old Entry, New Exit and Old Exit sets.</p><p id="a8a756b6-4e9a-43c1-865d-d9ac9d76f2e5" class>Additionally, it also contains the&#xA0;<strong>Merged Enter</strong>&#xA0;and the&#xA0;<strong>Merged Exit</strong>&#xA0;sets, which are basically the selection and rejection sets respectively. Together they make up the&#xA0;<strong>Complete Set</strong>, which is also available as shown in the code below:</p><pre id="f514c058-ae59-4e6f-9224-296412c8da97" class="code"><code>const { completeSet, mergedExit, mergedEnter } = selectionSet;</code></pre><p id="37f766a8-f48b-4a51-a8f5-80da4427709e" class>Each set has a unique set of row ids based on the DataModel attached to it and can be referred to as following:</p><p id="89847718-70ca-44b8-87dd-bfd76b487a2e" class><code>const uniqueIds = mergedEnter.uids;</code></p><h3 id="9981deac-74c6-4945-afc8-c9bedde3c364" class>Getting the context</h3><p id="14a09c35-3460-4301-a6d9-3badb97b2aef" class>The context for a Surrogate Side Effect is the instance based on which the sideeffect will be applied. As such, it provides each of the unit instances present in the canvas:</p><pre id="05e8b9b6-9acb-4641-b1c4-f7c0ebdd4fca" class="code"><code>const context = this.firebolt.context;</code></pre><p id="a5720c95-bbf6-4643-9fba-7bb582b47554" class>Each unit is made up of a set of layers. You can use the properties of these layers to modify the visual properties of the canvas. Each layer provides a set of methods and properties based on which you can modify said properties. We will now see how to use the layers to do so.</p><h3 id="bcedef75-c3f0-4336-a6ce-ffcfb007b8d6" class><strong>Applying the side effect</strong></h3><p id="79624b9f-d8f3-4048-97e1-2ac538a23031" class>Everytime the behaviour attached to this sideeffect is attached( for our example, when we select values), the&#xA0;<code>apply</code>&#xA0;method applies this side effect on each of the unit instances in the canvas.</p><p id="421055fa-af21-4ffe-9d70-8d1e177133aa" class>As such, when this behaviour changes, we&apos;ll have access to the selection and rejection sets and we can modify the required properties using the layers associated with the unit.</p><pre id="75753c59-eaab-40f1-8b7a-d1a2e8fee111" class="code"><code>apply(selectionSet) {
       const { completeSet, mergedExit, mergedEnter } = selectionSet;
       const context = this.firebolt.context;
       const layers = context.layers();
       layers.forEach((layer) =&gt; {
          const allElements = layer.getPlotElementsFromSet(completeSet.uids);
          allElements.forEach(elem =&gt; elem.style(&apos;stroke&apos;, &apos;&apos;).style(&apos;stroke-width&apos;, 2));
          const enterElements = layer.getPlotElementsFromSet(mergedEnter.uids);
          enterElements.forEach(elem =&gt; elem.style(&apos;stroke&apos;, &apos;red&apos;));
          const exitElements = layer.getPlotElementsFromSet(mergedExit.uids);
          exitElements.forEach(elem =&gt; elem.style(&apos;stroke&apos;, &apos;green&apos;));
      });
   }</code></pre><h3 id="af607ed8-b230-46d9-9201-35d027780862" class>Getting plot elements from set</h3><p id="8f5f99a5-7e91-4d76-81d0-5452182840bc" class>The&#xA0;<code>getPlotElementsFromSet</code>&#xA0;gets the elements attached to the respective part of the selection(or rejection sets). For instance,</p><p id="37f3a08e-449f-4f49-bbe5-03b79830adc2" class><code>layer.getPlotElementsFromSet(mergedEnter.uids)</code>: provides the elements attached to all the points that are present in the selection set,</p><p id="48222fa3-e841-42ec-879b-2ed48336b5ef" class><code>layer.getPlotElementsFromSet(mergedExit.uids)</code>: provides the elements attached to all the points that are present in the rejection set</p><p id="09e3389d-4b9d-45d5-b96a-17780984dd65" class><code>layer.getPlotElementsFromSet(completeSet.uids)</code>: provides all the plot elements in the layer.</p><h3 id="d9f9c1bc-f4f8-40d7-a924-871b74123976" class>Applying desired styles and/or attributes</h3><p id="d1064319-3785-4133-b03c-9216b37e1db2" class>Since the elements in the plot are SVG elements, you can apply either styles and/or SVG attributes to the plot elements. For instance, in the example here, we have added a stroke to all the bars based on whether they are present in the selection set or the rejection set:</p><pre id="b0483007-3bfe-4f3f-9abb-4389002986cf" class="code"><code>enterElements.style(&apos;stroke&apos;, &apos;red&apos;);
exitElements.style(&apos;stroke&apos;, &apos;green&apos;);</code></pre><p id="f479fb02-fb4f-4cb1-ae5a-09302b19c42d" class>Now, everytime you select bar(s) on the chart, the strokes on the respective bars will appear as red or green based on whether they are selected or not.</p><figure id="b1568ad6-033e-4964-bdea-8ad5ab0f3d2d"><div class="source"><iframe id="cp_embed_xxbRyoL" src="https://codepen.io/chartshq/embed/preview/xxbRyoL?height=600&amp;slug-hash=xxbRyoL&amp;default-tabs=js,result&amp;host=https://codepen.io&amp;editable=true" title="applying-desired-styles" scrolling="no" frameborder="0" height="600" allowtransparency="true" class="cp_embed_iframe" style="width: 100%; overflow: hidden;"></iframe></div></figure><h2 id="66b4035d-070b-4179-afd6-94de6f7ba696" class><strong>Wrapping Up</strong></h2><p id="d436d30b-d72e-4187-a154-e189b32d1c41" class>In this section we gave an overview of what it takes to add side effects to the canvas. To put it in brief:</p><ul id="b326edd1-1bc9-4fde-b18a-ecc8b3123c4e" class="bulleted-list"><li>We can choose to add our own custom side effects to the canvas</li></ul><ul id="208af19b-c984-4d9d-8fb0-3eb8ae89247b" class="bulleted-list"><li>These side effects can either be Spawnable(adding/removing elements) or Surrogate(modifying elements)</li></ul><ul id="69e16dc7-a135-412c-81de-5eb9239f5670" class="bulleted-list"><li>To add any side effect, a formal name has to be provided which uniquely defines the side effect</li></ul><ul id="26213a10-c8d8-4385-bc66-ede511ad93b4" class="bulleted-list"><li>To add a side effect, the selection set is available in the&#xA0;<code>apply</code>&#xA0;method which contains all the selection and rejection subsets like New Entry Set, Old Entry Set, New Exit Set, Old Exit Set, Complete Set, Merged Enter Set and Merged Exit Set</li></ul><ul id="30c6a28e-e422-45cf-a7a5-423155026495" class="bulleted-list"><li>To add a Spawnable Side effect, the drawing context is available with respect to the canvas where you can add/remove elements in either the&#xA0;<code>sideEffectGroup</code>&#xA0;or the&#xA0;<code>htmlContainer</code></li></ul><ul id="64df0f6c-9b22-47cb-b8af-2ed48a123c0a" class="bulleted-list"><li>To add a Surrogate Side effect, the context is available which is essentially each of the units attached to it and the layers that bind them</li></ul><ul id="424dda72-fbf2-40b6-ad4c-a32952814824" class="bulleted-list"><li>The&#xA0;<code>getPlotElementsFromSet</code>&#xA0;helps in getting elements attached to a particular selection set and elements can be modified using this set</li></ul></div></article></body><script>hljs.initHighlightingOnLoad();</script><script>hljs.initHighlightingOnLoad();</script></html>